name: Frontend â€“ Code Quality

on:
  workflow_call:
    inputs:
      setup-action:
        description: "Reusable setup action (Node, deps, etc.)"
        type: string
        default: santiago-garrote/setup-js-project@v1

      working-directory:
        description: "Project root directory"
        type: string
        default: frontend

      typecheck-command:
        description: "Command to run type checking"
        type: string
        default: ""

      lint-command:
        description: "Command to run linter"
        type: string
        default: ""

      format-command:
        description: "Command to run formatter check"
        type: string
        default: ""

      test-command:
        description: "Command to run tests"
        type: string
        default: ""

      coverage-path:
        description: "Relative path to generated coverage folder"
        type: string
        default: ""

      coverage-artifact-name:
        description: "Artifact name for coverage reports"
        type: string
        default: coverage-report

permissions:
  contents: read
  actions: read

jobs:
  typecheck:
    name: Type check
    if: ${{ inputs.typecheck-command != '' }}
    runs-on: ubuntu-latest
    steps:
      - uses: ${{ inputs.setup-action }}

      - name: Run type check
        working-directory: ${{ inputs.working-directory }}
        run: ${{ inputs.typecheck-command }}

  lint:
    name: Lint
    if: ${{ inputs.lint-command != '' }}
    runs-on: ubuntu-latest
    steps:
      - uses: ${{ inputs.setup-action }}

      - name: Run lint
        working-directory: ${{ inputs.working-directory }}
        run: ${{ inputs.lint-command }}

  format:
    name: Format check
    if: ${{ inputs.format-command != '' }}
    runs-on: ubuntu-latest
    steps:
      - uses: ${{ inputs.setup-action }}

      - name: Run format check
        working-directory: ${{ inputs.working-directory }}
        run: ${{ inputs.format-command }}

  test:
    name: Test
    if: ${{ inputs.test-command != '' }}
    runs-on: ubuntu-latest
    steps:
      - uses: ${{ inputs.setup-action }}

      - name: Run tests
        working-directory: ${{ inputs.working-directory }}
        run: ${{ inputs.test-command }}

      - name: Upload coverage artifact
        if: ${{ inputs.coverage-path != '' }}
        uses: actions/upload-artifact@v4
        with:
          name: ${{ inputs.coverage-artifact-name }}
          path: ${{ inputs.working-directory }}/${{ inputs.coverage-path }}
